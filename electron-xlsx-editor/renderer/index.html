<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <meta http-equiv="Content-Security-Policy"
        content="default-src 'self'; script-src 'self'; style-src 'self' 'unsafe-inline';" />
  <title>xlsx Editor</title>
  <link rel="stylesheet" href="./styles/app.css" />
  <!-- x-data-spreadsheet CSS -->
  <link rel="stylesheet" href="../node_modules/x-data-spreadsheet/dist/xspreadsheet.css" />
</head>
<body>
  <!-- ===== Toolbar ===== -->
  <div id="toolbar">
    <div class="toolbar-group">
      <button id="btn-open"  class="toolbar-btn" title="打开文件 (Ctrl+O)">📂 打开</button>
      <button id="btn-save"  class="toolbar-btn" title="另存为 (Ctrl+Shift+S)">💾 另存为</button>
    </div>
    <div class="toolbar-separator"></div>
    <div class="toolbar-group" id="style-toolbar">
      <button id="btn-bold"   class="toolbar-btn style-btn" title="粗体"><b>B</b></button>
      <button id="btn-italic" class="toolbar-btn style-btn" title="斜体"><i>I</i></button>
      <div class="color-picker-wrap" title="字体颜色">
        <label class="toolbar-btn color-label" style="cursor:pointer">
          <span>A</span>
          <input type="color" id="color-font" value="#000000" />
        </label>
      </div>
      <div class="color-picker-wrap" title="背景颜色">
        <label class="toolbar-btn color-label" style="cursor:pointer;background:#fff200;color:#000">
          <span>填充</span>
          <input type="color" id="color-bg" value="#ffffff" />
        </label>
      </div>
      <div class="toolbar-separator-sm"></div>
      <button id="btn-align-left"   class="toolbar-btn style-btn" title="左对齐">≡&lt;</button>
      <button id="btn-align-center" class="toolbar-btn style-btn" title="居中">≡</button>
      <button id="btn-align-right"  class="toolbar-btn style-btn" title="右对齐">&gt;≡</button>
    </div>
    <div class="toolbar-separator"></div>
    <div class="toolbar-group">
      <button id="btn-pull" class="toolbar-btn sync-btn" title="从服务端拉取数据" disabled>⬇ 拉取</button>
      <button id="btn-push" class="toolbar-btn sync-btn" title="推送数据到服务端" disabled>⬆ 推送</button>
      <button id="btn-settings" class="toolbar-btn" title="设置">⚙ 设置</button>
    </div>
  </div>

  <!-- ===== Drop overlay ===== -->
  <div id="drop-overlay">
    <div class="drop-message">📄 拖放 .xlsx / .xls 文件到这里</div>
  </div>

  <!-- ===== Spreadsheet container ===== -->
  <div id="spreadsheet-container"></div>

  <!-- ===== Settings Modal ===== -->
  <div id="modal-settings" class="modal hidden">
    <div class="modal-box">
      <h3>⚙ 设置</h3>
      <label>API Endpoint URL</label>
      <input id="cfg-endpoint" type="text" placeholder="https://example.com/api/data" />
      <label>Authorization Token（可选）</label>
      <input id="cfg-token" type="text" placeholder="Bearer token..." />
      <label>请求超时（毫秒）</label>
      <input id="cfg-timeout" type="number" value="30000" min="1000" />
      <div class="modal-actions">
        <button id="cfg-save" class="btn-primary">保存</button>
        <button id="cfg-cancel" class="btn-secondary">取消</button>
      </div>
    </div>
  </div>

  <!-- ===== Error Modal ===== -->
  <div id="modal-error" class="modal hidden">
    <div class="modal-box">
      <h3>⚠ 错误</h3>
      <p id="modal-error-msg"></p>
      <div class="modal-actions">
        <button id="modal-error-close" class="btn-primary">关闭</button>
      </div>
    </div>
  </div>

  <!-- ===== Toast ===== -->
  <div id="toast" class="toast hidden"></div>

  <!-- Scripts (loaded after DOM) -->
  <script src="../node_modules/x-data-spreadsheet/dist/xspreadsheet.js"></script>
  <script src="../node_modules/axios/dist/axios.min.js"></script>
  <script src="../node_modules/exceljs/dist/exceljs.min.js"></script>
  <script src="./modules/importer.js"></script>
  <script src="./modules/exporter.js"></script>
  <script src="./modules/syncer.js"></script>
  <script src="./modules/toolbar.js"></script>
  <script src="./renderer.js"></script>
</body>
</html>
